<!DOCTYPE html>
<html lang="en_US">
  <head>
    <meta charset="utf-8"/>
    <title>asciitool</title>
    <style>
      :root{
        --nord0:#2e3440;
        --nord1:#3b4252;
        --nord2:#434c5e;
        --nord3:#4c566a;
        --nord4:#d8dee9;
        --nord5:#e5e9f0;
        --nord6:#eceff4;
        --nord7:#8fbcbb;
        --nord8:#88c0d0;
        --nord9:#81a1c1;
        --nord10:#5e81ac;
        --nord11:#bf616a;
        --nord12:#d08770;
        --nord13:#ebcb8b;
        --nord14:#a3be8c;
        --nord15:#b48ead;
      }
      
      *{
        font-family:monospace;
        font-size:12px;
        color:var(--nord6);
      }
      *::selection{
        background-color:var(--nord3)
      }
      
      body,html{
        height:100%;
        margin:0;
      }
      body{
        background-color:var(--nord0);
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
      }
      
      input,textarea,button{
        border:none;
        margin:4px;
        padding:4px;
        background-color:var(--nord1);
        border-radius:4px;
        min-width:0
      }
      input:active,textarea:active,button:active{
        outline:2px solid var(--nord3);
      }
      input[type=number]{
        appearance:textfield;
        text-align:center;
      }
      
      #filecontrols{
        min-width:256px;
      }
      #fileinput{
        width:calc(100% - 72px);
      }
      #fileload{
        width:48px;
      }
      #doccontrols{
        display:flex
      }
      #doccontrols>*{
        flex:2;
      }
      #fontsize{
        flex:none;
        width:40px
      }
      #editor{
        min-width:256px;
        min-height:256px;
        background-size:calc(100% - 8px) calc(100% - 8px);
        font-weight:bold;
        overflow:hidden;
      }
    </style>
  </head>
  <body>
    <main>
      <div id="filecontrols">
        <input id="fileinput" placeholder="filepath"><button id="fileload">Load</button>
      </div>
      <div id="doccontrols">
        <button id="stretchmode">Stretch</button>
        <button id="fill">Fill</button>
        <button id="ins">Ins</button>
        <input id="fontsize" placeholder="font-size" value="12" type="number">
      </div>
      <textarea id="editor" spellcheck="false"></textarea>
    </main>
    <script>
      var fileinput    = document.querySelector("#fileinput");
      var fileload     = document.querySelector("#fileload");
      var stretchmode  = document.querySelector("#stretchmode");
      var fill         = document.querySelector("#fill");
      var ins          = document.querySelector("#ins");
      var editor       = document.querySelector("#editor");
      
      fileload.onclick = () => {
        editor.style.background =
          "linear-gradient(#3b4252AA, #3b4252AA),url('file://"
          + fileinput.value + "') no-repeat center center";
        editor.style.backgroundSize =
          "calc(100% - 8px) calc(100% - 8px)";
      }
      
      fileload.value & fileload.onclick();
      
      stretchmode.onclick = () => {
        if(stretchmode.innerText == "Scale") {
          stretchmode.innerText = "Stretch";
          editor.style.backgroundSize =
            "calc(100% - 8px) calc(100% - 8px)";
        } else {
          stretchmode.innerText = "Scale";
          editor.style.backgroundSize =
            "calc(100% - 8px) auto";
        }
      }
      
      // Needs work...
      fill.onclick = () => {
        editor.value = "";
        for(var y = 0; y < (editor.offsetHeight - 8) / 12; y++){
          for(var x = 0; x < (editor.offsetWidth - 8) / 12; x++)
            editor.value += " ";
          editor.value += "\n";
        }
      }
      
      ins.onclick = () => {
        if(ins.innerText == "Ins")
          ins.innerText = "Over";
        else
          ins.innerText = "Ins";
      }
      
      editor.onkeypress = (e) => {
        if(ins.innerText == "Ins") return true;
        var key = String.fromCharCode(
          e.which || e.charCode || e.keyCode
        );
        if(key != "\n") {
            var text = editor.value;
            var caret = editor.selectionStart;
            
            if(text[caret] == "\n") caret++;
            
            editor.value =
              text.substring(0, caret) +
              key +
              text.substring(caret + 1);
            
            caret++;
            editor.selectionStart = caret;
            editor.selectionEnd   = caret;
            return false;
        }
        return true;
      }
    </script>
  </body>
</html>
